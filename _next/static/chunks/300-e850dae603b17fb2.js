"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[300],{3300:function(e,t,n){var r=n(5666),c=n.n(r),a=n(813),u=n(7294),s=n(980),i=n(1529),o=n(6064),f=n(2804);function h(e,t,n,r,c,a,u){try{var s=e[a](u),i=s.value}catch(o){return void n(o)}s.done?t(i):Promise.resolve(i).then(r,c)}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,c=!1,a=void 0;try{for(var u,s=e[Symbol.iterator]();!(r=(u=s.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(i){c=!0,a=i}finally{try{r||null==s.return||s.return()}finally{if(c)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}t.Z=function(){var e,t=new a.DB("log"),n=p(u.useState(!1),2),r=n[0],l=n[1],d=(0,s.useToast)(),v=new i.Z,x=((0,f.Zl)(o.K5),(0,f.Zl)(o.eY),e=c().mark((function e(n){var r,a,u,s,i,o,f,h,p,l,d,x,b,k,w,y,m,g,O,S,P,T;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.openDB();case 2:return e.next=4,v.getLogs(n);case 4:return r=e.sent,e.next=7,t.getAll();case 7:for(a=e.sent,u=[],s=[],i=!0,o=!1,f=void 0,e.prev=11,h=a[Symbol.iterator]();!(i=(p=h.next()).done);i=!0)l=p.value,r.find((function(e){return e.code===l.code}))||r.find((function(e){return e.date===l.date}))||s.push(l);e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),o=!0,f=e.t0;case 19:e.prev=19,e.prev=20,i||null==h.return||h.return();case 22:if(e.prev=22,!o){e.next=25;break}throw f;case 25:return e.finish(22);case 26:return e.finish(19);case 27:for(d=!0,x=!1,b=void 0,e.prev=28,k=r[Symbol.iterator]();!(d=(w=k.next()).done);d=!0)y=w.value,a.find((function(e){return e.code===y.code}))||a.find((function(e){return e.date===y.date}))||u.push(y);e.next=36;break;case 32:e.prev=32,e.t1=e.catch(28),x=!0,b=e.t1;case 36:e.prev=36,e.prev=37,d||null==k.return||k.return();case 39:if(e.prev=39,!x){e.next=42;break}throw b;case 42:return e.finish(39);case 43:return e.finish(36);case 44:return e.next=46,t.addMulti(u);case 46:m=!0,g=!1,O=void 0,e.prev=47,S=s[Symbol.iterator]();case 49:if(m=(P=S.next()).done){e.next=56;break}return T=P.value,e.next=53,v.addLog(n,T);case 53:m=!0,e.next=49;break;case 56:e.next=62;break;case 58:e.prev=58,e.t2=e.catch(47),g=!0,O=e.t2;case 62:e.prev=62,e.prev=63,m||null==S.return||S.return();case 65:if(e.prev=65,!g){e.next=68;break}throw O;case 68:return e.finish(65);case 69:return e.finish(62);case 70:case"end":return e.stop()}}),e,null,[[11,15,19,27],[20,,22,26],[28,32,36,44],[37,,39,43],[47,58,62,70],[63,,65,69]])})),function(){var t=this,n=arguments;return new Promise((function(r,c){var a=e.apply(t,n);function u(e){h(a,r,c,u,s,"next",e)}function s(e){h(a,r,c,u,s,"throw",e)}u(void 0)}))});return[r,function(e){x(e).then((function(){l(!0)})).catch((function(){d({title:"\u30af\u30e9\u30a6\u30c9\u3068\u540c\u671f\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f",description:"\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044",status:"error"})}))}]}},1529:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(5666),c=n.n(r),a=n(3892);function u(e,t,n,r,c,a,u){try{var s=e[a](u),i=s.value}catch(o){return void n(o)}s.done?t(i):Promise.resolve(i).then(r,c)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,c){var a=e.apply(t,n);function s(e){u(a,r,c,s,i,"next",e)}function i(e){u(a,r,c,s,i,"throw",e)}s(void 0)}))}}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){o(e,t,n[t])}))}return e}var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api="https://api.tdu.app",this.userApi="".concat(this.api,"/user"),this.logApi="".concat(this.api,"/log")}var t,n,r;return t=e,(n=[{key:"createAccount",value:function(e){return s(c().mark((function t(){var n,r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=this.fetchOption("POST")).body="user_name=".concat(e),t.next=4,fetch(this.userApi,n);case 4:return r=t.sent,t.next=7,this.checkStatus(r);case 7:return t.next=9,r.json();case 9:return t.abrupt("return",t.sent.id);case 10:case"end":return t.stop()}}),t,this)})).bind(this))()}},{key:"getUserInfo",value:function(e){return s(c().mark((function t(){var n,r,a,u;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={method:"GET"},t.next=3,fetch("".concat(this.userApi,"?id=").concat(e),n);case 3:return r=t.sent,t.next=6,this.checkStatus(r);case 6:return t.next=8,r.json();case 8:return a=t.sent,u={id:a.id,name:a.name,numberOfLogs:a.number_of_logs,createDate:a.create_date,updateDate:new Date},t.abrupt("return",u);case 11:case"end":return t.stop()}}),t,this)})).bind(this))()}},{key:"changeName",value:function(e,t){return s(c().mark((function n(){var r,a;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r=this.fetchOption("POST")).body="id=".concat(e,"&user_name=").concat(t),n.next=4,fetch(this.userApi,r);case 4:return a=n.sent,n.next=7,this.checkStatus(a);case 7:case"end":return n.stop()}}),n,this)})).bind(this))()}},{key:"deleteUser",value:function(e){return s(c().mark((function t(){var n,r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.fetchOption("DELETE"),t.next=3,fetch("".concat(this.userApi,"?id=").concat(e),n);case 3:return r=t.sent,t.next=6,this.checkStatus(r);case 6:case"end":return t.stop()}}),t,this)})).bind(this))()}},{key:"rank",value:function(){return s(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.fetchOption("GET"),e.next=3,fetch("".concat(this.api,"/rank"),t);case 3:return n=e.sent,e.next=6,this.checkStatus(n);case 6:return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})).bind(this))()}},{key:"addLog",value:function(e,t){return s(c().mark((function n(){var r,a;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r=this.fetchOption("POST")).body="id=".concat(e,"&date=").concat(t.date.toISOString(),"&campus=").concat(t.campus,"&log_type=").concat(t.type,"&code=").concat(t.code),n.next=4,fetch(this.logApi,r);case 4:return a=n.sent,n.next=7,this.checkStatus(a);case 7:case"end":return n.stop()}}),n,this)})).bind(this))()}},{key:"getLogs",value:function(e){return s(c().mark((function t(){var n,r,u,s,i,o,f,h,p,l;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.fetchOption("GET"),t.next=3,fetch("".concat(this.logApi,"?id=").concat(e),n);case 3:return r=t.sent,t.next=6,this.checkStatus(r);case 6:return t.next=8,r.json();case 8:for(u=t.sent,s=[],i=!0,o=!1,f=void 0,t.prev=11,h=u[Symbol.iterator]();!(i=(p=h.next()).done);i=!0)l=p.value,s.push({campus:this.selectCampus(l.campus),code:l.code,type:a.h[l.log_type],label:l.label,date:new Date(l.date)});t.next=19;break;case 15:t.prev=15,t.t0=t.catch(11),o=!0,f=t.t0;case 19:t.prev=19,t.prev=20,i||null==h.return||h.return();case 22:if(t.prev=22,!o){t.next=25;break}throw f;case 25:return t.finish(22);case 26:return t.finish(19);case 27:return t.abrupt("return",s);case 28:case"end":return t.stop()}}),t,this,[[11,15,19,27],[20,,22,26]])})).bind(this))()}},{key:"checkStatus",value:function(e){return s(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ok){t.next=11;break}return t.t0=Error,t.t1="".concat(e.status,": "),t.next=5,e.text();case 5:if(t.t2=t.sent,t.t2){t.next=8;break}t.t2="No Text";case 8:throw t.t3=t.t2,t.t4=t.t1.concat.call(t.t1,t.t3),new t.t0(t.t4);case 11:case"end":return t.stop()}}),t)})))()}},{key:"selectCampus",value:function(e){switch(e){case"\u5343\u4f4f":return a.V.senju;case"\u9ce9\u5c71":return a.V.hatoyama}}},{key:"fetchOption",value:function(e){var t={credentials:"include",mode:"cors"};return f("POST"===e?{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}}:{method:e},t)}}])&&i(t.prototype,n),r&&i(t,r),e}()}}]);